# Neovim
## 1. Vim 与 Neovim

Vim 是一款基于 TUI 的文字编辑器, 由另一种文字编辑器 Vi 改进而来, 其核心特性是只使用键盘就能够完成文字编辑功能, 同时 Vim 提供了语法着色、插件支持等高级编辑功能, 是一种具备高级功能的文字编辑器

[Neovim](https://neovim.io/) 是 Vim 一个重构分支, 在继承并兼容 Vim 常规特性的同时提供了更为现代化的特性, 如内建语言服务器、第一类支持 lua5.1/luajit 作为其配置语言、插件系统、异步系统等等; 在重构后, Neovim 具有相对干净的源代码从而使其易于维护, 同时具有更好的运行效率

```
$ brew install neovim
$ nvim --version
$ nvim									# 从当前 shell-path 进入文本编辑
```

## 2. 操作框架

Vim/Nvim 启动后, 默认处于 Normal 模式, 在任何其他模式下按下 `Esc` 都将返回到 Normal 模式

<img src="./assets/vim-mode.png" style="zoom:50%;" />

|    模式     |                 说明                 |
| :---------: | :----------------------------------: |
| **Normal**  |             执行命令操作             |
| **Command** |       内部控制台, 执行控制指令       |
| **Visual**  |    选择连续区域字符, 执行命令操作    |
| **V-Line**  |     选择连续行字符, 执行命令操作     |
| **V-Block** |   选择连续矩形块字符, 执行命令操作   |
|   Insert    |       一般性输入, 在光标处输入       |
|   Replace   | 替换性输入, 从光标处开始替换后续文本 |

**命令操作**: 在非输入模式下, 键盘按键都将视为命令, 不同命令有不同效果, 允许用户自行配置 

```shell
:h[elp] [<string>]						# 打开帮助手册, 或根据输入字符串搜索相关内容
```

<img src="./assets/vim-system.png" style="zoom:50%;" />

**缓冲区**: 一份 Vim/Nvim 文件实质是一片内存, 所有修改都发生在内存上, 执行 **显式写入操作** 后保存修改至硬盘

**窗口屏**: 窗口屏绑定一块缓冲区, 用于对缓冲区内容的展示与编辑, 多个窗口屏可以绑定同一块缓冲区, 自动同步

**选项卡**:选项卡是窗口屏的集合, 选项卡之间相互叠加, 同一时刻只有一个选项卡可视

+ **默认**: 启动 Vim/Nvim 后, 默认打开一个选项卡, 选项卡只有一个窗口屏, 该窗口屏绑定默认缓冲区

| 选项卡 |      控制指令      | 命令 | 说明                                                         |
| :----: | :----------------: | :--: | ------------------------------------------------------------ |
|  新建  | `:tabnew [<file>]` |      | 1. 新建 Tab (1-Win), 载入指定文件, 或创建空缓冲区<br />2. 别名: `:tabe[dit]` |
|  列出  |      `:tabs`       |      | 列出当前所有的 Tab                                           |
|  关闭  |   `:tabc[lose]`    |      | 关闭当前 Tab 以及其拥有的 Win, 不影响缓冲区                  |
|  移动  |    `:tabn[ext]`    | `gt` | 循环下一个                                                   |
|  移动  |  `:tabp[revious]`  | `gT` | 循环上一个                                                   |

| 窗口屏 |       控制指令       |         命令         | 说明                              |
| :----: | :------------------: | :------------------: | --------------------------------- |
|  水平  | `:sp[lit] [<file>]`  |                      | 水平分屏, 默认当前窗口绑定的文件  |
|  水平  |        `:new`        |                      | 水平分屏, 创建空文件              |
|  垂直  | `:vs[plit] [<file>]` |                      | 垂直分屏, 默认当前窗口绑定的文件  |
|  移动  |                      | `C-W + h | j |k | l` | 在同一 Tab 下的窗口屏之间移动光标 |

`:q[uit]`: 关闭当前窗口屏

+ 若当前被关闭的窗口屏为 Tab 的唯一, 则关闭 Tab, 不影响该 Tab 下窗口所创建的缓冲区
+ 若当前被关闭的选项卡为 Vim 的唯一, 则退出 Vim, 退出 Vim 将导致缓冲区被销毁, **此时可能退出失败**

| 缓冲区 |          控制指令           | 命令 |                 说明                 |
| :----: | :-------------------------: | :--: | :----------------------------------: |
|  新建  |      `:edit [<file>]`       |      |  将当前窗口所绑定的缓冲区切换为其他  |
|  列出  | `:buffers`、`:ls`、`:files` |      |         列出当前所有的缓冲区         |
|  关闭  |    `:bd[elete][<file>]`     |      | 关闭当前活动的缓冲区, 或指定的缓冲区 |
|  写入  |         `:w[rite]`          |      |  将当前缓冲区的修改保存到对应文件中  |

+ 关闭缓冲区时, 若缓冲区存在未写入文件的修改, 则 **关闭失败并报错**

```shell
:q[uit]a[ll]								# 关闭选项卡下的所有窗口
```

| 路径控制指令 | 说明                     |
| :----------: | ------------------------ |
|    `:pwd`    | 当前的工作环境的根路径   |
| `:cd <path>` | 改变当前工作环境的根路径 |

**控制指令自动补全**: Vim/Nvim 的 `:` 系列控制指令支持输入时使用 `<Tab>` 进行自动补全

+ **控制指令名称**: 根据当前输入内容自动补全可以匹配的控制指令
+ **文件路径参数**: 基于 **当前工作路径** 或 **缓冲区条目**, 根据当前输入内容自动补全参数

## 3. 语法规则

## 4. 编辑指南

### 4.1 移动光标

### 4.2 编辑操作

复制、粘贴、撤销、重做

缩进

### 4.3 视图模式

### 4.4 搜索替换



宏与脚本







## Nvim 个人配置

1. 常规配置: `lua/basic.lua`
2. 操作配置: `lua/keybinding.lua`

## Nvim 特性说明
